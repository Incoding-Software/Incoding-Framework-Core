@using Incoding.Web.MvcContrib
@using Incoding.WebTest.Operations
@using Microsoft.AspNetCore.Routing
@model Incoding.WebTest.Operations.AddItemCommand

@using (Html.Incoding().BeginPush(setting =>
{
    setting.OnSuccess = dsl => dsl.WithId(nameof(GetItemsQuery)).Trigger.Incoding();
}))
{
    @Html.For(r => r.ItemId).DropDown(control =>
    {
        control.Data = Html.Dispatcher().Query(new GetDDEntitiesQuery {SelectedValues = new List<Guid>()}).Items.ToSelectList(vm => vm.Value, vm => vm.Text); // Url.Dispatcher().Query(new GetDDEntitiesQuery<UserRole> {SelectedValues = Model.RoleIds}).AsJson();
        //control.Attr(new RouteValueDictionary {{"multiple", "multiple"}, { "data-plugin-multiselect", "data-plugin-multiselect" } });
    })
    @Html.ForGroup(r => r.OriginalValue).TextBox(control => control.Label.Name = "Value:")
    @Html.Incoding().Submit("Save")
}




@(Html.When(JqueryBind.Click)
      .AjaxPost(dispatcher => dispatcher.Push<ClearItemCacheCommand>())
      .OnSuccess(dsl => dsl.WithId(nameof(GetItemsQuery)).Trigger.Incoding())
      .AsHtmlAttributes()
      .ToButton("Clear Cache and Refresh"))